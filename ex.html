<!DOCTYPE html>
<html>

<head>
  <link rel="icon" type="image/png" href="/favicon.png">
  <script async src="//www.googletagservices.com/tag/js/gpt.js"></script>
  <script async src="prebid.js"></script>
  <script>
    var div_1_sizes = [
      [990, 250],
    ];
    var div_2_sizes = [
      [300, 600],
      [300, 250]
    ];
    var PREBID_TIMEOUT = 1000;
    var FAILSAFE_TIMEOUT = 3000;

    var adUnits = [
      {
        code: '/45577845/Tatler_test/wide_banner_1',
        mediaTypes: {
          banner: {
            sizes: [[990, 250]],
          },
        },
        bids: [
          {
            bidder: 'between',
            params: {
              placementId: 12345,
              w: 970,
              h: 250,
              s: 2667423,
            }
          },
        ]
      },
      {
        code: '/45577845/Tatler_test/skyscraper_inner',
        mediaTypes: {
          banner: {
            sizes: [[300, 600], [300, 250]],
          },
        },
        bids: [
          {
            bidder: 'between',
            params: {
              placementId: 12345,
              w: 970,
              h: 250,
              s: 2667407,
            }
          },
        ]
      }
    ];

    // ======== DO NOT EDIT BELOW THIS LINE =========== //
    var googletag = googletag || {};
    googletag.cmd = googletag.cmd || [];
    googletag.cmd.push(function() {
      googletag.pubads().disableInitialLoad();
    });

    var pbjs = pbjs || {};
    pbjs.que = pbjs.que || [];

    pbjs.que.push(function() {
      pbjs.setConfig({ debug: true });
      pbjs.addAdUnits(adUnits);
      pbjs.requestBids({
        bidsBackHandler: initAdserver,
        timeout: PREBID_TIMEOUT
      });
    });

    var code__ = 0;

    function initAdserver(e) {
      if (pbjs.initAdserverSet) return;

      console.log('handler->', e["/45577845/Tatler_test/wide_banner_1"].bids[0].requestId);
      code__ = e["/45577845/Tatler_test/wide_banner_1"].bids[0].requestId;


      pbjs.initAdserverSet = true;
      googletag.cmd.push(function() {
        pbjs.que.push(function() {
          pbjs.setTargetingForGPTAsync();
          googletag.pubads().refresh();
        });
      });

      //['/45577845/Tatler_test/wide_banner_1', '/45577845/Tatler_test/skyscraper_inner'].forEach(function(code) {
      //  let params = pbjs.getAdserverTargetingForAdUnitCode(code);
      //  console.log('params', params);
      //});

    }
    // in case PBJS doesn't load
    setTimeout(function() {
      initAdserver();
    }, FAILSAFE_TIMEOUT);

    googletag.cmd.push(function() {
      googletag.defineSlot('/45577845/Tatler_test/wide_banner_1', div_1_sizes, 'wide_banner_1').addService(googletag.pubads());
      googletag.pubads().enableSingleRequest();
      googletag.enableServices();
    });
    googletag.cmd.push(function() {
      googletag.defineSlot('/45577845/Tatler_test/skyscraper_inner', div_2_sizes, 'skyscraper_inner').addService(googletag.pubads());
      googletag.pubads().enableSingleRequest();
      googletag.enableServices();
    });

  </script>

</head>

<body>
<h2>Basic Prebid.js Example</h2>
<div class="wrapper">
  <div class="left-col">
    <h5>wide_banner_1</h5>
    <div id='wide_banner_1'>
      <script type='text/javascript'>
        googletag.cmd.push(function() {
          googletag.display('wide_banner_1');
        });

      </script>
    </div>
  </div>
  <div class="right-col">
    <h5>skyscraper_inner</h5>
    <div id='skyscraper_inner'>
      <script type='text/javascript'>
        googletag.cmd.push(function() {
          googletag.display('skyscraper_inner');
        });

      </script>
    </div>
  </div>

</div>

<hr>

<div id="btw">
  <script type='text/javascript'>
    setTimeout(function() {
      var myFrame = document.createElement('iframe');
      myFrame.src = 'frame.html';
      document.getElementById('btw').append(myFrame);
    }, 3000);
  </script>
</div>


<style>
  .wrapper > div{
    display: inline-block;
  }
  .left-col {
    width: 65%;
    margin-right: 10px;
  }
  .rigth-col {
    width: 30%;
  }
</style>

</body>

</html>